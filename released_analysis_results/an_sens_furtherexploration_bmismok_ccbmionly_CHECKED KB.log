----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\hiv-research\analysis\output/an_sens_furtherexploration_bmismok_ccbmionly.log
  log type:  text
 opened on:   1 Sep 2020, 08:50:43

. 
. run global 

. 
. use "cr_create_analysis_dataset_STSET_onsdeath_fail1", clear
(Analysis dataset HIV project)

. 
. use "an_impute_imputeddata", clear
(Analysis dataset HIV project)

. 
. **************************
. *  Analyse imputed data  *
. **************************
. 
. // Declare imputed data as survival
. 
. mi stset stime_onsdeath, fail(onsdeath==1) enter(enter_date)    ///
>         origin(enter_date) id(patient_id)

                id:  patient_id
     failure event:  onsdeath == 1
obs. time interval:  (stime_onsdeath[_n-1], stime_onsdeath]
 enter on or after:  time enter_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time enter_date

------------------------------------------------------------------------------
   17282435  total observations
          0  exclusions
------------------------------------------------------------------------------
   17282435  observations remaining, representing
   17282435  subjects
     14,882  failures in single-failure-per-subject data
 2.4481e+09  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =       142

. /*
> if "`1'"=="omitbmismok"{
> local adjlist_nobmismok = subinstr("$adjustmentlist", "i.obese4cat", "", 1)
> local adjlist_nobmismok = subinstr("`adjlist_nobmismok'", "i.smoke_nomiss", "", 1)
> mi estimate, eform: stcox i.hiv i.ethnicity `adjlist_nobmismok', strata(stp)
> estimates save "./output/models/an_sens_furtherexploration_bmismok_`1'", replace                                                
> }
> 
> if "`1'"=="omitbmismokinccpop"{
> local adjlist_nobmismok = subinstr("$adjustmentlist", "i.obese4cat", "", 1)
> local adjlist_nobmismok = subinstr("`adjlist_nobmismok'", "i.smoke_nomiss", "", 1)
> mi estimate, eform: stcox i.hiv i.ethnicity `adjlist_nobmismok' if bmicat<. & smoke<., strata(stp)
> estimates save "./output/models/an_sens_furtherexploration_bmismok_`1'", replace                                                
> }
> */
. if "`1'"=="ccbmismok"{
. mi estimate, eform: stcox i.hiv i.ethnicity age1 age2 age3 i.male i.imd i.smoke_nomiss i.obese4cat if bmicat<. & smoke<., strata
> (stp)
. estimates save "./output/models/an_sens_furtherexploration_bmismok_`1'", replace                                                
. }

. 
. if "`1'"=="ccbmionly"{
. mi estimate, eform: stcox i.hiv i.ethnicity age1 age2 age3 i.male i.imd i.smoke_nomiss i.obese4cat if bmicat<., strata(stp)

Multiple-imputation estimates                   Imputations       =         10
Stratified Cox regr.: Breslow method for ties   Number of obs     = 13,540,731
                                                Average RVI       =     0.0586
                                                Largest FMI       =     0.4043
DF adjustment:   Large sample                   DF:     min       =      60.73
                                                        avg       =   7.44e+09
                                                        max       =   6.60e+10
Model F test:       Equal FMI                   F(  18,50439.8)   =    1434.54
Within VCE type:          OIM                   Prob > F          =     0.0000

-----------------------------------------------------------------------------------------
                     _t |     exp(b)   Std. Err.      t    P>|t|     [95% Conf. Interval]
------------------------+----------------------------------------------------------------
                  1.hiv |   2.183324   .5034732     3.39   0.001     1.389414    3.430874
                        |
              ethnicity |
                 Mixed  |   1.491995   .2074392     2.88   0.006     1.129836    1.970241
Asian or Asian British  |   1.583866   .0672905    10.82   0.000     1.456824    1.721986
                 Black  |   1.618542   .0961858     8.10   0.000     1.440512    1.818575
                 Other  |    1.36873   .1204779     3.57   0.000     1.151502    1.626938
                        |
                   age1 |   1.161318   .0260506     6.67   0.000     1.111366    1.213515
                   age2 |   .9102301   .0437541    -1.96   0.050     .8283895    1.000156
                   age3 |   1.291512    .142617     2.32   0.021     1.040168    1.603591
                 1.male |     1.6855   .0302388    29.10   0.000     1.627262    1.745821
                        |
                    imd |
                     2  |    1.14405   .0328732     4.68   0.000     1.081401    1.210329
                     3  |   1.262348   .0363505     8.09   0.000     1.193075    1.335642
                     4  |   1.583554   .0448648    16.22   0.000     1.498018    1.673975
       5 most deprived  |   1.869927   .0544255    21.50   0.000      1.76624      1.9797
                        |
           smoke_nomiss |
                Former  |   1.368656   .0266396    16.12   0.000     1.317426    1.421877
               Current  |    1.17257   .0442699     4.22   0.000     1.088935    1.262629
                        |
              obese4cat |
     Obese I (30-34.9)  |   1.102562   .0257217     4.19   0.000     1.053283    1.154146
    Obese II (35-39.9)  |   1.592099   .0540327    13.70   0.000     1.489643    1.701603
       Obese III (40+)  |   2.299981   .1083271    17.68   0.000     2.097169    2.522407
-----------------------------------------------------------------------------------------
. estimates save "./output/models/an_sens_furtherexploration_bmismok_`1'", replace                                                
file ./output/models/an_sens_furtherexploration_bmismok_ccbmionly.ster saved
. }

. 
. if "`1'"=="ccsmokonly"{
. mi estimate, eform: stcox i.hiv i.ethnicity age1 age2 age3 i.male i.imd i.smoke_nomiss i.obese4cat if smoke<., strata(stp)
. estimates save "./output/models/an_sens_furtherexploration_bmismok_`1'", replace                                                
. }

. 
. 
. log close
      name:  <unnamed>
       log:  e:\analyses\hiv-research\analysis\output/an_sens_furtherexploration_bmismok_ccbmionly.log
  log type:  text
 closed on:   1 Sep 2020, 12:45:41
----------------------------------------------------------------------------------------------------------------------------------
