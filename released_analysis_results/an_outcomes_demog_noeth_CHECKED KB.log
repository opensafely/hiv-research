----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\hiv-research\analysis\output/an_outcomes_demog_noeth.log
  log type:  text
 opened on:  16 Jul 2020, 19:21:36

. 
. run global 

. 
. use "cr_create_analysis_dataset_STSET_onsdeath_fail1", clear
(Analysis dataset HIV project)

. 
. if "`1'"=="rates_agesex"{
. strate hiv, per(365000) output(./output/an_outcomes_RATES, replace)
. 
. 
. ******************************
. *  Age-sex Cox model  *
. ******************************
. capture stcox age1 age2 age3 i.male i.hiv, strata(stp) 
. if _rc==0 {
.                 noi di _n  "AGE-SEX ADJUSTED (FULL STUDY POP)" _n 
.                 estimates
.                 estimates save ./output/models/an_outcomes_agesex, replace
.                 }
.         else {
.         di "WARNING - AGESEX MODEL DID NOT SUCCESSFULLY FIT"
.         }
. 
. }

. 
. 
. **************************************
. *  Demographics +/- ethnicity model  *
. **************************************
. 
. if "`1'"=="demog_cceth"{
. capture stcox age1 age2 age3 i.male i.imd i.ethnicity i.hiv, strata(stp) 
. if _rc==0 {
.                 noi di _n "DEMOGRAPHICS ADJUSTED INCLUDING ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_outcomes_adjdemographics_inceth, replace
.                 }
.         else di "WARNING - hiv adj demog inc CC eth MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. if "`1'"=="demog_noeth"{
. capture stcox age1 age2 age3 i.male i.imd i.hiv, strata(stp) 
. if _rc==0 {
.                 noi di _n  "DEMOGRAPHICS ADJUSTED EXCLUDING ETHNICITY (FULL STUDY POP)" _n 

DEMOGRAPHICS ADJUSTED EXCLUDING ETHNICITY (FULL STUDY POP)

.                 estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   17,282,435                  Number of obs    =  17,282,435
No. of failures =       14,882
Time at risk    =   2448136011
                                                LR chi2(9)       =    48106.85
Log likelihood  =   -176442.19                  Prob > chi2      =      0.0000

----------------------------------------------------------------------------------
              _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-----------------+----------------------------------------------------------------
            age1 |   1.169496   .0223516     8.19   0.000     1.126499    1.214136
            age2 |   .9132487   .0378154    -2.19   0.028     .8420597    .9904561
            age3 |   1.252458   .1197692     2.35   0.019     1.038401    1.510641
          1.male |    1.69093   .0281678    31.53   0.000     1.636614    1.747049
                 |
             imd |
              2  |   1.168976    .031862     5.73   0.000     1.108166    1.233123
              3  |   1.312631   .0358425     9.96   0.000     1.244228    1.384795
              4  |   1.684871   .0451126    19.48   0.000     1.598732    1.775651
5 most deprived  |    2.04371   .0557002    26.23   0.000     1.937404    2.155849
                 |
           1.hiv |   2.709395   .5437246     4.97   0.000     1.828319    4.015064
----------------------------------------------------------------------------------
                                                             Stratified by stp
.                 estimates save ./output/models/an_outcomes_adjdemographics_noeth, replace
file ./output/models/an_outcomes_adjdemographics_noeth.ster saved
.                 }
.         else di "WARNING - hiv adj demog no eth MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. ******************************
. *  Multivariable Cox model  *
. ******************************
. 
. if "`1'"=="mv_cceth"{
. capture stcox   i.hiv i.ethnicity $adjustmentlist , strata(stp)
. if _rc==0 {
.                 noi di _n "FULLY ADJUSTED MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_outcomes_adjfull_inceth, replace
.                 }
.         else di "WARNING - hiv adj demog inc CC eth MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. if "`1'"=="mv_noeth"{
. capture stcox   i.hiv $adjustmentlist , strata(stp)
. if _rc==0 {
.                 noi di _n "FULLY ADJUSTED MODEL NO ETHNICITY " _n 
.                 estimates
.                 estimates save ./output/models/an_outcomes_adjfull_noeth, replace
.                 }
.         else di "WARNING - hiv full adj exc eth MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. if "`1'"=="mv_addhepc"{
. capture stcox   i.hiv  i.ethnicity i.hepc $adjustmentlist , strata(stp)
. if _rc==0 {
.                 noi di _n "FULLY ADJUSTED MODEL INC ETHNICITY (COMPLETE CASES) PLUS HEP C" _n 
.                 estimates
.                 estimates save ./output/models/an_outcomes_adjfull_plushepc_inceth, replace
.                 }
.         else di "WARNING - hiv full adj plus hepc inc eth MODEL DID NOT SUCCESSFULLY FIT"
. }

.         
. log close
      name:  <unnamed>
       log:  E:\analyses\hiv-research\analysis\output/an_outcomes_demog_noeth.log
  log type:  text
 closed on:  16 Jul 2020, 19:43:51
----------------------------------------------------------------------------------------------------------------------------------
