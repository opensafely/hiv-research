----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\hiv-research\analysis\output/an_interactions_byethnicity_wvsb.log
  log type:  text
 opened on:  30 Aug 2020, 16:17:31

. 
. run global

. 
. use "cr_create_analysis_dataset_STSET_onsdeath_fail1", clear
(Analysis dataset HIV project)

. 
. *By age
. if "`1'"=="byage"{
. gen ageover60 = agegroup>=4
. capture stcox   i.hiv i.ethnicity $adjustmentlist 1.hiv#1.ageover60 , strata(stp)
. if _rc==0 {
.                 noi di _n "AGE INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_interactions_ageover60, replace
.                 }
.         else di "WARNING - hiv age-interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. *By sex
. if "`1'"=="bysex"{
. gen female = 1-male
. capture stcox   i.hiv i.ethnicity $adjustmentlist 1.hiv#1.female, strata(stp)
. if _rc==0 {
.                 noi di _n "AGE INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_interactions_female, replace
.                 }
.         else di "WARNING - hiv male interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. *By black/non-black
. if "`1'"=="byethnicity"{
. gen nonblack = (ethnicity != 4) if ethnicity<.
. capture stcox   i.hiv i.ethnicity $adjustmentlist 1.hiv#1.nonblack, strata(stp)
. if _rc==0 {
.                 noi di _n "BLACK/NON-BLACK INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_interactions_nonblack, replace
.                 }
.         else di "WARNING - hiv black/non-black interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. *By black/white 
. if "`1'"=="byethnicity_wvsb"{
. gen whitevsblack = (ethnicity != 4) if ethnicity<.
(4,562,695 missing values generated)
. capture stcox   i.hiv i.ethnicity age1 age2 age3 i.imd 1.hiv#1.whitevsblack if (ethnicity==1|ethnicity==4), strata(stp)
. if _rc==0 {
.                 noi di _n "BLACK/NON-BLACK INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 

BLACK/NON-BLACK INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)

.                 estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   11,231,108                  Number of obs    =  11,231,108
No. of failures =       10,246
Time at risk    =   1613091761
                                                LR chi2(10)      =    32324.90
Log likelihood  =   -117689.15                  Prob > chi2      =      0.0000

----------------------------------------------------------------------------------
              _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
-----------------+----------------------------------------------------------------
           1.hiv |   4.626128   1.424222     4.98   0.000     2.530246    8.458096
                 |
       ethnicity |
          Black  |   1.514471   .0949002     6.62   0.000     1.339438    1.712376
            age1 |   1.163234   .0307817     5.71   0.000     1.104441    1.225157
            age2 |   .9333571   .0527425    -1.22   0.222     .8355026    1.042672
            age3 |   1.184747   .1535621     1.31   0.191     .9189592    1.527407
                 |
             imd |
              2  |   1.221986   .0404117     6.06   0.000     1.145293    1.303815
              3  |   1.348021   .0448948     8.97   0.000     1.262839    1.438948
              4  |   1.697864   .0555805    16.17   0.000     1.592349     1.81037
5 most deprived  |   2.031863   .0674816    21.35   0.000     1.903814    2.168524
                 |
hiv#whitevsblack |
            1 1  |   .4992942   .2266185    -1.53   0.126     .2051234     1.21534
----------------------------------------------------------------------------------
                                                             Stratified by stp
.                 estimates save ./output/models/an_interactions_whitevsblack, replace
file ./output/models/an_interactions_whitevsblack.ster saved
.                 lincom 1.hiv + 1.hiv#1.whitevsblack, eform

 ( 1)  1.hiv + 1.hiv#1.whitevsblack = 0

------------------------------------------------------------------------------
          _t |     exp(b)   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   2.309799   .7712684     2.51   0.012     1.200462    4.444267
------------------------------------------------------------------------------
.                 }
.         else di "WARNING - hiv black/white interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

.         
. *By comorbidity status
. if "`1'"=="bycomorbidities"{
. gen anycomorbidity =                                            ///
>                         hypertension                                    ///
>                         |chronic_respiratory_disease    ///
>                         |(asthmacat>1)                                  ///
>                         |chronic_cardiac_disease                ///
>                         |(diabcat>1)                                    ///
>                         |(cancer_exhaem_cat>1)                  ///
>                         |(cancer_haem_cat>1)                    ///
>                         |chronic_liver_disease                  ///
>                         |stroke_dementia                                ///
>                         |other_neuro                                    ///
>                         |(reduced_kidney_function_cat>1)        ///
>                         |organ_transplant                               ///
>                         |spleen                                                 ///
>                         |ra_sle_psoriasis                               ///
>                         |other_imm_except_hiv           
. capture stcox   i.hiv i.ethnicity $adjustmentlist 1.hiv#1.anycomorbidity, strata(stp)
. if _rc==0 {
.                 noi di _n "ANY_COMORBIDITY INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_interactions_anycomorbidity, replace
.                 }
.         else di "WARNING - hiv any_comorbidity interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. log close
      name:  <unnamed>
       log:  e:\analyses\hiv-research\analysis\output/an_interactions_byethnicity_wvsb.log
  log type:  text
 closed on:  30 Aug 2020, 16:29:49
----------------------------------------------------------------------------------------------------------------------------------
