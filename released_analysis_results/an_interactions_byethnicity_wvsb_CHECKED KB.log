----------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  e:\analyses\hiv-research\analysis\output/an_interactions_byethnicity_wvsb.log
  log type:  text
 opened on:   1 Sep 2020, 08:50:35

. 
. run global

. 
. use "cr_create_analysis_dataset_STSET_onsdeath_fail1", clear
(Analysis dataset HIV project)

. 
. *By age
. if "`1'"=="byage"{
. gen ageover60 = agegroup>=4
. capture stcox   i.hiv i.ethnicity $adjustmentlist 1.hiv#1.ageover60 , strata(stp)
. if _rc==0 {
.                 noi di _n "AGE INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_interactions_ageover60, replace
.                 }
.         else di "WARNING - hiv age-interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. *By sex
. if "`1'"=="bysex"{
. gen female = 1-male
. capture stcox   i.hiv i.ethnicity $adjustmentlist 1.hiv#1.female, strata(stp)
. if _rc==0 {
.                 noi di _n "AGE INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_interactions_female, replace
.                 }
.         else di "WARNING - hiv male interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. *By black/non-black
. if "`1'"=="byethnicity"{
. gen nonblack = (ethnicity != 4) if ethnicity<.
. capture stcox   i.hiv i.ethnicity $adjustmentlist 1.hiv#1.nonblack, strata(stp)
. if _rc==0 {
.                 noi di _n "BLACK/NON-BLACK INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_interactions_nonblack, replace
.                 }
.         else di "WARNING - hiv black/non-black interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. *By black/white 
. if "`1'"=="byethnicity_wvsb"{
. gen whitevsblack = (ethnicity != 4) if ethnicity<.
(4,562,695 missing values generated)
. capture stcox   i.hiv i.ethnicity age1 age2 age3 i.male i.imd i.smoke_nomiss i.obese4cat 1.hiv#1.whitevsblack if (ethnicity==1|e
> thnicity==4), strata(stp)
. if _rc==0 {
.                 noi di _n "BLACK/NON-BLACK INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 

BLACK/NON-BLACK INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)

.                 estimates

----------------------------------------------------------------------------------------------------------------------------------
active results
----------------------------------------------------------------------------------------------------------------------------------

Stratified Cox regr. -- Breslow method for ties

No. of subjects =   11,231,108                  Number of obs    =  11,231,108
No. of failures =       10,246
Time at risk    =   1613091761
                                                LR chi2(16)      =    33501.93
Log likelihood  =   -117100.64                  Prob > chi2      =      0.0000

-------------------------------------------------------------------------------------
                 _t | Haz. Ratio   Std. Err.      z    P>|z|     [95% Conf. Interval]
--------------------+----------------------------------------------------------------
              1.hiv |   4.812519   1.481396     5.10   0.000     2.632416    8.798131
                    |
          ethnicity |
             Black  |   1.574599   .0989175     7.23   0.000     1.392184    1.780914
               age1 |   1.178912   .0324214     5.98   0.000      1.11705      1.2442
               age2 |   .8859655   .0517749    -2.07   0.038     .7900843    .9934823
               age3 |   1.376785   .1841053     2.39   0.017     1.059358    1.789327
             1.male |    1.60247   .0327904    23.04   0.000     1.539474    1.668045
                    |
                imd |
                 2  |   1.209098   .0400002     5.74   0.000     1.133187    1.290095
                 3  |   1.319849   .0440188     8.32   0.000     1.236334    1.409007
                 4  |   1.647075   .0541256    15.18   0.000     1.544335     1.75665
   5 most deprived  |   1.939108   .0649792    19.76   0.000     1.815844    2.070741
                    |
       smoke_nomiss |
            Former  |   1.416784   .0317668    15.54   0.000      1.35587    1.480434
           Current  |   1.249919   .0529981     5.26   0.000     1.150243    1.358231
                    |
          obese4cat |
 Obese I (30-34.9)  |   1.085042   .0298487     2.97   0.003     1.028088     1.14515
Obese II (35-39.9)  |   1.564763    .062674    11.18   0.000     1.446622    1.692552
   Obese III (40+)  |    2.18981   .1233544    13.91   0.000     1.960909    2.445432
                    |
   hiv#whitevsblack |
               1 1  |   .4205643   .1909134    -1.91   0.056      .172756    1.023839
-------------------------------------------------------------------------------------
                                                             Stratified by stp
.                 estimates save ./output/models/an_interactions_whitevsblack, replace
file ./output/models/an_interactions_whitevsblack.ster saved
.                 lincom 1.hiv + 1.hiv#1.whitevsblack, eform

 ( 1)  1.hiv + 1.hiv#1.whitevsblack = 0

------------------------------------------------------------------------------
          _t |     exp(b)   Std. Err.      z    P>|z|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
         (1) |   2.023974   .6760062     2.11   0.035      1.05173    3.894985
------------------------------------------------------------------------------
.                 }
.         else di "WARNING - hiv black/white interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

.         
. *By comorbidity status
. if "`1'"=="bycomorbidities"{
. gen anycomorbidity =                                            ///
>                         hypertension                                    ///
>                         |chronic_respiratory_disease    ///
>                         |(asthmacat>1)                                  ///
>                         |chronic_cardiac_disease                ///
>                         |(diabcat>1)                                    ///
>                         |(cancer_exhaem_cat>1)                  ///
>                         |(cancer_haem_cat>1)                    ///
>                         |chronic_liver_disease                  ///
>                         |stroke_dementia                                ///
>                         |other_neuro                                    ///
>                         |(reduced_kidney_function_cat>1)        ///
>                         |organ_transplant                               ///
>                         |spleen                                                 ///
>                         |ra_sle_psoriasis                               ///
>                         |other_imm_except_hiv           
. capture stcox   i.hiv i.ethnicity $adjustmentlist 1.hiv#1.anycomorbidity, strata(stp)
. if _rc==0 {
.                 noi di _n "ANY_COMORBIDITY INTERACTION MODEL INC ETHNICITY (COMPLETE CASES)" _n 
.                 estimates
.                 estimates save ./output/models/an_interactions_anycomorbidity, replace
.                 }
.         else di "WARNING - hiv any_comorbidity interaction MODEL DID NOT SUCCESSFULLY FIT"
. }

. 
. log close
      name:  <unnamed>
       log:  e:\analyses\hiv-research\analysis\output/an_interactions_byethnicity_wvsb.log
  log type:  text
 closed on:   1 Sep 2020, 09:11:50
----------------------------------------------------------------------------------------------------------------------------------
